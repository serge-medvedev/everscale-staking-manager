[![sergemedvedev/freeton-staking-manager](https://img.shields.io/docker/cloud/build/sergemedvedev/freeton-staking-manager.svg)](https://hub.docker.com/r/sergemedvedev/freeton-staking-manager)
![version](https://img.shields.io/github/package-json/v/serge-medvedev/freeton-staking-manager)

# FreeTON Staking Manager

## HOWTO

- Refer to [config.js.example](config.js.example) to create the config file
- Make sure you have the client private key and the server public key, generated by _setup.sh_ script during validator engine initialization
- Build the image and run a container with [docker-compose](docker-compose.yml):
    ```yaml
    version: "2.3"
    services:
      freeton-staking-manager:
        image: sergemedvedev/freeton-staking-manager
        volumes:
          - ./config.js:/usr/src/app/config.js:ro
          - ./certs:/usr/src/app/certs:ro
          - ./db:/data/freeton-staking-manager
        ports:
          - "3000:3000"
        environment:
          DEBUG: "app,api,lib:*"
        restart: always
    ```
    ```console
    $ docker-compose up -d
    ```

## API Reference

### POST /stake/:action
Tries to send/recover/resize a stake

> __:action__ "send", "recover" or "resize"

Example:
```console
$ curl -XPOST localhost:3000/stake/send
```

Pass the value as a query parameter to resize the stake:

```console
$ curl -XPOST localhost:3000/stake/resize?value=20000
```
---

### POST /elections/:action
Allows to skip upcoming elections (no idea why one would need it)

> __:action__ "skip" or "participate"

Example:
```console
$ curl -XPOST localhost:3000/elections/skip
```
---

### GET /elections/history
Returns info (keys, stake, etc.) about elections the node participated in

Example:
```console
$ curl -s localhost:3000/elections/history | jq '.'
```
---

### GET /timediff
Returns the node's sync status

Example:
```console
$ curl localhost:3000/timediff
```
---

### GET /wallet/balance
Returns the node's wallet balance (in nanotokens)

Example:
```console
$ curl localhost:3000/wallet/balance
```
---

## TODO

- Add more HTTP API docs